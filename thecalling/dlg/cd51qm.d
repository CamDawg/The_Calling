BEGIN CD51QM

//START

CHAIN IF ~NumTimesTalkedTo(0) Global("CDGnollQuest","GLOBAL",0)~ THEN CD51QM 01.00
@10063
END
IF~~THEN REPLY @10064 EXTERN CD51QM 01.01
IF~~THEN REPLY @10065 EXTERN CD51QM 01.01

CHAIN CD51QM 01.01
@10066
==CD51QM @10067
==cd51qm @10192
==~%MINSC_JOINED%~  IF ~InParty("MINSC")  !StateCheck("MINSC",CD_STATE_NOTVALID)~  THEN @10068
==~%EDWIN_JOINED%~  IF ~InParty("EDWIN")  !StateCheck("EDWIN",CD_STATE_NOTVALID)~  THEN @10069
==~%KHALID_JOINED%~ IF ~InParty("KHALID") !StateCheck("KHALID",CD_STATE_NOTVALID)~ THEN @10070
==CD51QM @10071
END
IF~~THEN REPLY @10072 EXTERN CD51QM 01.02
IF~~THEN REPLY @10073 EXTERN CD51QM 01.03x

CHAIN CD51QM 01.02
@10074
==CD51QM @10075
==CD51QM @10076
==CD51QM @10077
END
IF~~THEN REPLY @10078 EXTERN CD51QM 01.03
IF~~THEN REPLY @10079 EXTERN CD51QM 01.03

CHAIN CD51QM 01.03
@10080
END
IF~~THEN REPLY @10081 EXTERN CD51QM 01.04
IF~~THEN REPLY @10082 EXTERN CD51QM 01.05

CHAIN CD51QM 01.04
@10083
EXTERN CD51QM 01.06

CHAIN CD51QM 01.05
@10084
EXTERN CD51QM 01.06

CHAIN CD51QM 01.06
@10085
==CD51QM @10086
END
IF~~THEN REPLY @10087 EXTERN CD51QM 01.07
IF~~THEN REPLY @10088 EXTERN CD51QM 01.07
IF~~THEN REPLY @10089 EXTERN CD51QM 01.07

CHAIN CD51QM 01.07
@10090
DO ~SetGlobal("CDGnollQuest","GLOBAL",1) EraseJournalEntry(@10174) AddJournalEntry(@10175,QUEST)~ EXIT

CHAIN CD51QM 01.03x
@10091
DO ~AddJournalEntry(@10174,QUEST)~ EXIT

CHAIN IF ~NumTimesTalkedToGT(0) Global("CDGnollQuest","GLOBAL",0)~ THEN CD51QM 01.0R
@10092
END
IF~~THEN REPLY @10093 EXTERN CD51QM 01.01
IF~~THEN REPLY @10094 EXIT

//Leaders Dead

CHAIN IF ~Global("CDGnollQuest","GLOBAL",1)~ THEN CD51QM 02.00
@10095
END
IF~Dead("CD51GS") Dead("CD51CH") Dead("CD51GO")~THEN REPLY @10096 EXTERN CD51QM 02.01
IF~~THEN REPLY @10097 EXIT

CHAIN CD51QM 02.01
@10098
==CD51QM @10099
DO ~SetGlobal("CDGnollQuest","GLOBAL",2) EraseJournalEntry(@10179) EraseJournalEntry(@10175) AddJournalEntry(@10180,QUEST)~ EXIT

//Next Step

CHAIN IF ~Global("CDGnollQuest","GLOBAL",3)~ THEN CD51QM 03.00
@10100
END
IF~~THEN REPLY @10101 EXTERN CD51QM 03.01
IF~~THEN REPLY @10102 EXIT

CHAIN CD51QM 03.01
@10103
==CD51QM @10104
END
IF~~THEN REPLY @10105 EXTERN CD51QM 03.02
IF~~THEN REPLY @10106 EXTERN CD51QM 03.02
IF~~THEN REPLY @10107 EXIT

CHAIN CD51QM 03.02
@10108
END
IF~~THEN REPLY @10109 EXTERN CD51QM 03.03
IF~~THEN REPLY @10110 EXTERN CD51QM 03.04
IF~~THEN REPLY @10111 EXIT

CHAIN CD51QM 03.03
@10112
EXTERN CD51QM 03.05

CHAIN CD51QM 03.04
@10113
EXTERN CD51QM 03.05

CHAIN CD51QM 03.05
@10114
==CD51QM @10115
==CD51QM @10116
DO ~SetGlobal("CDGnollQuest","GLOBAL",4) EraseJournalEntry(@10180) AddJournalEntry(@10181,QUEST)~ EXIT  

//Waiting for the supplies

CHAIN IF ~Global("CDGnollQuest","GLOBAL",4)~ THEN CD51QM 04.00
@10117
END
IF~PartyHasItem("CD51SUP")~THEN REPLY @10118 EXTERN CD51QM 04.01
IF~~THEN REPLY @10119 EXIT

CHAIN CD51QM 04.01
@10120
DO ~TakePartyItem("CD51SUP") SetGlobal("CDGnollQuest","GLOBAL",5)~ EXIT

//They Arrived

BEGIN CD51SOL3

CHAIN IF ~Global("CDGnollQuest","GLOBAL",6)~ THEN CD51QM 05.00
@10121
==CD51SOL3 @10122
==CD51QM @10123
==CD51QM @10124
==CD51SOL3 @10125
==CD51QM @10126
==CD51SOL3 @10127
==CD51QM @10128
==CD51QM @10129
==CD51SOL3 @10130
==CD51QM @10131
END
IF~~THEN REPLY @10132 EXTERN CD51SOL3 05.01
IF~~THEN REPLY @10133 EXTERN CD51SOL3 05.02

CHAIN CD51SOL3 05.01
@10134
EXTERN CD51SOL3 05.03

CHAIN CD51SOL3 05.02
@10135
EXTERN CD51SOL3 05.03

CHAIN CD51SOL3 05.03
@10136
==CD51QM @10137
==CD51SOL3 @10138
==CD51QM @10139
==CD51QM @10140
DO ~SetGlobal("CDGnollQuest","GLOBAL",7) EraseJournalEntry(@10182) AddJournalEntry(@10183,QUEST)~ EXIT

//The final favor

CHAIN IF ~Global("CDGnollQuest","GLOBAL",7)~ THEN CD51QM 06.00
@10141
END
IF~~THEN REPLY @10142 EXTERN CD51QM 06.01
IF~~THEN REPLY @10143 EXIT

CHAIN CD51QM 06.01
@10144
==CD51QM @10193
==CD51QM @10145
==CD51QM @10146
END
IF~~THEN REPLY @10147 EXTERN CD51QM 06.02
IF~~THEN REPLY @10148 EXIT

CHAIN CD51QM 06.02
@10149
DO ~SetGlobal("CDGnollQuest","GLOBAL",8) EraseJournalEntry(@10183) AddJournalEntry(@10184,QUEST)~ EXIT

//Awaiting Final

CHAIN IF ~Global("CDGnollQuest","GLOBAL",8)~ THEN CD51QM 07.00
@10150
END
IF~Dead("CD51GHO")~THEN REPLY @10151 EXTERN CD51QM 07.01
IF~~THEN REPLY @10152 EXIT

CHAIN CD51QM 07.01
@10153
==CD51QM @10154
==CD51QM @10155
==CD51QM @10156
DO ~AddXPObject(Player1,750)  AddexperienceParty(3000) GiveGoldForce(600) GiveItemCreate("CD51REW",Player1,1,1,0) SetGlobal("CDGnollQuest","GLOBAL",9) AddJournalEntry(@10186,QUEST_DONE)
EraseJournalEntry(@10174) EraseJournalEntry(@10175) EraseJournalEntry(@10176) EraseJournalEntry(@10177) EraseJournalEntry(@10178) EraseJournalEntry(@10179) EraseJournalEntry(@10180) 
EraseJournalEntry(@10181) EraseJournalEntry(@10182) EraseJournalEntry(@10183) EraseJournalEntry(@10184)~ EXIT // probably not strictly necessary, but I hate leftover journals

//End

CHAIN IF ~Global("CDGnollQuest","GLOBAL",9)~ THEN CD51QM 08.00
@10157
EXIT


